#!/bin/bash

set -e

. `dirname $0`/devhelper-common

g=com.sonatype.nexus
a=nexus-professional
v=${1-LATEST}
r=${REPO-public}
if [[ ${v} == *:* ]]
then
    v=`echo $v | sed -e "s/:/ /g"`
read g a v <<EOF
$v
EOF
fi

if [ "$USE_GAV_DIR" = "true" ]
then
    dir="$g.$a-$v-remote"
    mkdir "$dir"
    opts="-C $dir"
fi
curl "$NEXUS/service/local/artifact/maven/redirect?r=$r&g=$g&a=$a&c=bundle&e=tar.gz&v=$v" --netrc-optional -L | tar xz $opts
